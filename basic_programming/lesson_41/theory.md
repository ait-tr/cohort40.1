# Lesson 41


В Java, исключения (`exceptions`) являются объектами, которые описывают исключительную ситуацию, возникающую в процессе выполнения программы. Исключения используются для обработки ошибок и других нештатных ситуаций в управляемом и структурированном виде.

### Типы исключений

В Java исключения делятся на две основные категории:

1. **Проверяемые исключения (`checked exceptions`)**: Это исключения, которые должны быть явно перехвачены или объявлены в методе. Они представляют собой условия, от которых можно восстановиться. Например, `IOException` возникает при ошибках ввода/вывода, и программа может попытаться решить проблему или корректно её обработать.

2. **Непроверяемые исключения (`unchecked exceptions`)**: Включают в себя ошибки (`errors`) и исключения времени выполнения (`runtime exceptions`). Ошибки, как правило, описывают внутренние проблемы в работе виртуальной машины Java или недостаток ресурсов, и от них восстановление обычно не предполагается (например, `OutOfMemoryError`). Исключения времени выполнения указывают на ошибки в логике программы, которые могут быть предотвращены перед выполнением (например, `NullPointerException`).

### Иерархия исключений

Все классы исключений в Java наследуются от класса `Throwable`. От него напрямую наследуются два класса: `Error` (описывает внутренние системные ошибки) и `Exception` (исключения, которые может обрабатывать приложение). `RuntimeException` является подклассом `Exception` и служит базовым классом для всех непроверяемых исключений времени выполнения.

### Обработка исключений

Обработка исключений в Java осуществляется с помощью блоков `try`, `catch` и `finally`:

- **`try`**: Код, в котором может возникнуть исключение, помещается внутри блока `try`.

- **`catch`**: После блока `try` следует один или несколько блоков `catch`, перехватывающих и обрабатывающих исключения. Каждый блок `catch` обрабатывает определённый тип исключения.

- **`finally`**: Блок `finally` содержит код, который будет выполнен после блока `try/catch`, независимо от того, возникло ли исключение. Это идеальное место для освобождения ресурсов, таких как закрытие файлов или сетевых соединений.

### Пример

```java
try {
    // Код, который может вызвать исключение
} catch (SpecificExceptionType e) {
    // Обработка конкретного типа исключения
} catch (AnotherExceptionType e) {
    // Обработка другого типа исключения
} finally {
    // Код, выполняемый всегда после блоков try/catch
}
```

Использование исключений позволяет разрабатывать надёжные и устойчивые к ошибкам приложения, правильно обрабатывая исключительные ситуации.

Давайте разберём более подробно работу с исключениями в Java, включая различные способы их обработки и создания собственных типов исключений, снабдив это более разнообразными примерами.

### 1. Обработка исключений с использованием `try-catch`

Java использует конструкцию `try-catch` для обработки исключений. В блоке `try` размещается код, который может вызвать исключение, а в блоке `catch` — код для его обработки.

#### Пример: деление на ноль с обработкой исключения

```java
public class DivisionExample {
    public static void main(String[] args) {
        try {
            int a = 5;
            int b = 0; // Делитель равен нулю
            int result = a / b;
            System.out.println("Результат: " + result);
        } catch (ArithmeticException e) {
            System.out.println("Ошибка арифметики: Деление на ноль.");
        }
    }
}
```

### 2. Множественный `catch`

Вы можете перехватывать несколько типов исключений, используя несколько блоков `catch`. Java проверяет исключения в том порядке, в котором они указаны, поэтому убедитесь, что более специфичные исключения перехватываются перед более общими.

#### Пример: Обработка разных типов исключений

```java
public class MultipleCatchExample {
    public static void main(String[] args) {
        try {
            String input = args[0];
            System.out.println("Первый символ: " + input.charAt(0));
            System.out.println("Число, полученное из строки: " + Integer.parseInt(input));
        } catch (ArrayIndexOutOfBoundsException e) {
            System.out.println("Аргумент не был предоставлен.");
        } catch (NumberFormatException e) {
            System.out.println("Введённая строка не является числом.");
        } catch (Exception e) {
            System.out.println("Произошла неизвестная ошибка.");
        }
    }
}
```

### 3. Блок `finally`

Блок `finally` исполняется после выполнения блоков `try` и `catch`, независимо от того, было ли исключение перехвачено или нет. Это идеальное место для кода, который должен выполняться в любом случае, например, для закрытия файлов или освобождения ресурсов.

#### Пример с `finally`

```java
public class FinallyExample {
    public static void main(String[] args) {
        try {
            int[] numbers = {1, 2, 3};
            System.out.println(numbers[5]);
        } catch (ArrayIndexOutOfBoundsException e) {
            System.out.println("Индекс вне диапазона массива.");
        } finally {
            System.out.println("Этот код выполняется всегда.");
        }
    }
}
```

### 4. Создание собственных исключений

Вы можете определить собственные типы исключений, наследуя класс `Exception` или `RuntimeException`. Это позволяет создавать более специфичные типы ошибок для вашего приложения.

#### Пример: Собственное исключение

```java
class MyException extends Exception {
    public MyException(String message) {
        super(message);
    }
}

public class CustomExceptionExample {
    public static void main(String[] args) {
        try {
            throw new MyException("Это моё исключение.");
        } catch (MyException e) {
            System.out.println(e.getMessage());
        }
    }
}
```

### 5. Использование `throws`

Ключевое слово `throws` используется в сигнатуре метода для указания, что метод может выбросить исключение. Это требует от вызывающего кода обработать исключение или дальше пробросить его.

#### Пример с `throws`

```java
public class ThrowsExample {
    static void checkAge(int age) throws ArithmeticException {
        if (age < 18) {
            throw new ArithmeticException("Доступ запрещён.");
        } else {
            System.out.println("Доступ разрешён.");
        }
    }

    public static void main(String[] args) {
        try {
            checkAge(15);
        } catch (ArithmeticException e) {
            System.out.println("Исключение: " + e.getMessage());
        }
    }
}
```

Эти примеры демонстрируют базовые и некоторые продвинутые аспекты работы с исключениями в Java,
подчёркивая важность правильной обработки ошибок для создания надёжных приложений.